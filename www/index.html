<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Testing phonegap plugins</title>
  </head>
  <body>
    <textarea id="mylogs" style="width: 100%; height: 100%;">
    </textarea>

    <script type="text/javascript" src="cordova.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.5.0/firebase.js"></script>
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
    <script>
      function mylog(msg) {
        console.log(msg);
        document.getElementById('mylogs').value += msg + "\n";
      }

      mylog('waiting for deviceready5');
      document.addEventListener("deviceready", onDeviceReady);
      
      function onDeviceReady() {
        mylog('Got deviceready');
        //setUpFcm();
        //signInWithGoogle();
      }
/*
      function signInWithGoogle() {
        var provider = new firebase.auth.GoogleAuthProvider();
        firebase.auth().signInWithRedirect(provider).then(function() {
          return firebase.auth().getRedirectResult();
        }).then(function(result) {
          // This gives you a Google Access Token.
          // You can use it to access the Google API.
          var token = result.credential.accessToken;
          // The signed-in user info.
          var user = result.user;
          mylog('Google login succeeded! token=' + token + ' user=' + user.uid);
        }).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          mylog('Google login failed! errorCode=' + errorCode + ' errorMessage=' + errorMessage);
        });
      }

      function setUpFcm() {
        if (!PushNotification) {
          mylog("PushNotification not installed!");
          return;
        }
        const push = PushNotification.init({
          android: {
          },
            browser: {
                pushServiceURL: 'http://push.api.phonegap.com/v1/push'
            },
          ios: {
            alert: "true",
            badge: "true",
            sound: "true"
          },
          windows: {}
        });

        push.on('registration', (data) => {
          mylog("registration data=" + JSON.stringify(data) );
          // data.registrationId
        });

        push.on('notification', (data) => {
          mylog("notification data=" + JSON.stringify(data) );
          // data.message,
          // data.title,
          // data.count,
          // data.sound,
          // data.image,
          // data.additionalData
        });

        push.on('error', (e) => {
          mylog("error e=" + JSON.stringify(e) );
          // e.message
        });
      }
      */
    </script>
  </body>
</html>
